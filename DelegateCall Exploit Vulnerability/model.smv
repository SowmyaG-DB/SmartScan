MODULE main
VAR
 state : {"Start", "UpgradeRequested", "ExploitOccurred"};
 owner : address;
ASSIGN
 init(state) := "Start";
 init(owner) := 0;
 next(state) := case
 state = "Start" : "UpgradeRequested";
 state = "UpgradeRequested" : "ExploitOccurred";
 TRUE : state;
 esac;

-- DelegateCall Exploit
SPEC AG (state = "UpgradeRequested" -> EF state = "ExploitOccurred");
