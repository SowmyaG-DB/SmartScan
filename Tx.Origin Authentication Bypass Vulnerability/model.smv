MODULE main
VAR
 state : {"Start", "WithdrawAttempted", "FundsWithdrawn"};
 owner : address;
ASSIGN
 init(state) := "Start";
 init(owner) := 0x0;
 next(state) := case
 state = "Start" : "WithdrawAttempted";
 state = "WithdrawAttempted" : "FundsWithdrawn";
 TRUE : state;
 esac;

-- Tx Origin Vulnerability
SPEC AG (state = "WithdrawAttempted" -> tx.origin == owner);
